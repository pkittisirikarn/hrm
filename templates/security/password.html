{% extends "base.html" %}
{% block title %}เปลี่ยนรหัสผ่าน{% endblock %}
{% block content %}
<div class="bg-white rounded-lg shadow p-6 space-y-4 max-w-md">
  <h2 class="text-2xl font-bold">เปลี่ยนรหัสผ่าน</h2>
  <form id="f" class="space-y-3">
    <label class="block">
      <div class="text-sm text-gray-600">รหัสผ่านเดิม</div>
      <input type="password" id="old" class="w-full border rounded-lg px-3 py-2" required />
    </label>
    <label class="block">
      <div class="text-sm text-gray-600">รหัสผ่านใหม่ (อย่างน้อย 8 ตัวอักษร)</div>
      <input type="password" id="new" class="w-full border rounded-lg px-3 py-2" required minlength="8" />
    </label>
    <button class="px-4 py-2 rounded-lg bg-blue-600 text-white">บันทึก</button>
  </form>
</div>

<script>
document.getElementById('f-change')?.addEventListener('submit', async (e)=>{
  e.preventDefault();
  const fd = new FormData(e.target);
  const r = await fetch('/api/v1/security/password/change', {method:'POST', body: fd});
  if (r.ok) { alert('บันทึกสำเร็จ'); e.target.reset(); }
  else { const t = await r.text(); alert('ไม่สำเร็จ: '+t); }
});
</script>
{% endblock %}
