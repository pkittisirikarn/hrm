<!-- templates/time_tracking/working_schedules.html -->
{% extends "base.html" %}
{% block content %}
<div class="max-w-7xl mx-auto p-6">
  <h1 class="text-2xl font-semibold mb-4">ตารางเวลาทำงาน (Working Schedules)</h1>

  <!-- Add Form -->
  <form id="addWorkingScheduleForm" class="grid grid-cols-1 md:grid-cols-3 gap-4 bg-white p-4 rounded-lg shadow">
    <div>
      <label class="block text-sm font-medium">Employee ID (optional)</label>
      <input id="addEmployeeId" type="number" class="mt-1 w-full border rounded px-3 py-2" placeholder="เว้นว่าง = ใช้เป็น template">
    </div>

    <div>
      <label class="block text-sm font-medium">ชื่อ</label>
      <input id="addName" type="text" class="mt-1 w-full border rounded px-3 py-2" required>
    </div>

    <div>
      <label class="block text-sm font-medium">วัน</label>
      <select id="addDayOfWeek" class="mt-1 w-full border rounded px-3 py-2" required>
        <option value="">-- เลือกวัน --</option>
        <option>Monday</option>
        <option>Tuesday</option>
        <option>Wednesday</option>
        <option>Thursday</option>
        <option>Friday</option>
        <option>Saturday</option>
        <option>Sunday</option>
      </select>
    </div>

    <div class="md:col-span-3 grid grid-cols-1 md:grid-cols-5 gap-4">
      <div>
        <label class="block text-sm font-medium">เป็นวันทำงาน?</label>
        <input id="addIsWorkingDay" type="checkbox" class="mt-2" checked>
      </div>
      <div>
        <label class="block text-sm font-medium">เริ่มงาน</label>
        <input id="addStartTime" type="time" class="mt-1 w-full border rounded px-3 py-2" value="09:00">
      </div>
      <div>
        <label class="block text-sm font-medium">เลิกงาน</label>
        <input id="addEndTime" type="time" class="mt-1 w-full border rounded px-3 py-2" value="18:00">
      </div>
      <div>
        <label class="block text-sm font-medium">พักเริ่ม</label>
        <input id="addBreakStartTime" type="time" class="mt-1 w-full border rounded px-3 py-2" value="12:00">
      </div>
      <div>
        <label class="block text-sm font-medium">พักสิ้นสุด</label>
        <input id="addBreakEndTime" type="time" class="mt-1 w-full border rounded px-3 py-2" value="13:00">
      </div>
    </div>

    <!-- Policy block -->
    <div class="md:col-span-3 grid grid-cols-1 md:grid-cols-5 gap-4">
      <div>
        <label class="block text-sm font-medium">Late In (นาที)</label>
        <input id="addLateGraceMin" type="number" min="0" class="mt-1 w-full border rounded px-3 py-2" placeholder="เช่น 5">
      </div>
      <div>
        <label class="block text-sm font-medium">Early-out (นาที)</label>
        <input id="addEarlyLeaveGraceMin" type="number" min="0" class="mt-1 w-full border rounded px-3 py-2" placeholder="เช่น 0">
      </div>
      <div>
        <label class="block text-sm font-medium">Absence if &lt; (นาที)</label>
        <input id="addAbsenceAfterMin" type="number" min="0" class="mt-1 w-full border rounded px-3 py-2" placeholder="เช่น 240">
      </div>
      <div>
        <label class="block text-sm font-medium">มาตรฐาน/วัน (นาที)</label>
        <input id="addStandardDailyMinutes" type="number" min="0" class="mt-1 w-full border rounded px-3 py-2" placeholder="เช่น 480">
      </div>
      <div>
        <label class="block text-sm font-medium">พัก (override นาที)</label>
        <input id="addBreakMinutesOverride" type="number" min="0" class="mt-1 w-full border rounded px-3 py-2" placeholder="ว่าง=คำนวณจากช่วงพัก">
      </div>
    </div>

    <div class="md:col-span-3 grid grid-cols-1 md:grid-cols-3 gap-4">
      <div>
        <label class="block text-sm font-medium">Active?</label>
        <input id="addIsActive" type="checkbox" class="mt-2" checked>
      </div>
      <div>
        <label class="block text-sm font-medium">ตั้งเป็นค่าเริ่มต้น?</label>
        <input id="addIsDefault" type="checkbox" class="mt-2">
      </div>
      <div class="flex items-end">
        <button class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded">เพิ่ม</button>
      </div>
    </div>

    <div id="addWorkingScheduleMessage" class="md:col-span-3 mt-2 text-sm"></div>
  </form>

  <!-- Table -->
  <div class="mt-6 bg-white rounded-lg shadow overflow-x-auto">
    <table class="min-w-full divide-y divide-gray-200">
      <thead class="bg-gray-50">
        <tr>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ID</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">EmpID</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ชื่อ</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">วัน</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ทำงาน?</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ชั่วโมง</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">พัก</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Late/Early/Abs</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Std(min)</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Active/Default</th>
          <th class="px-6 py-3"></th>
        </tr>
      </thead>
      <tbody id="workingSchedulesTableBody" class="bg-white divide-y divide-gray-200"></tbody>
    </table>
    <div id="workingSchedulesMessage" class="p-4 text-sm"></div>
  </div>
</div>

<!-- Edit Modal -->
<div id="editWorkingScheduleModal" class="fixed inset-0 hidden items-center justify-center bg-black/30">
  <div class="bg-white w-full max-w-3xl p-6 rounded-lg shadow">
    <h2 class="text-lg font-semibold mb-4">แก้ไขตารางงาน</h2>
    <form id="editWorkingScheduleForm" class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <input id="editWorkingScheduleId" type="hidden">

      <div>
        <label class="block text-sm font-medium">Employee ID</label>
        <input id="editEmployeeId" type="number" class="mt-1 w-full border rounded px-3 py-2">
      </div>

      <div>
        <label class="block text-sm font-medium">ชื่อ</label>
        <input id="editName" type="text" class="mt-1 w-full border rounded px-3 py-2" required>
      </div>

      <div>
        <label class="block text-sm font-medium">วัน</label>
        <select id="editDayOfWeek" class="mt-1 w-full border rounded px-3 py-2" required>
          <option>Monday</option><option>Tuesday</option><option>Wednesday</option>
          <option>Thursday</option><option>Friday</option><option>Saturday</option><option>Sunday</option>
        </select>
      </div>

      <div>
        <label class="block text-sm font-medium">เป็นวันทำงาน?</label>
        <input id="editIsWorkingDay" type="checkbox" class="mt-2">
      </div>
      <div>
        <label class="block text-sm font-medium">เริ่มงาน</label>
        <input id="editStartTime" type="time" class="mt-1 w-full border rounded px-3 py-2">
      </div>
      <div>
        <label class="block text-sm font-medium">เลิกงาน</label>
        <input id="editEndTime" type="time" class="mt-1 w-full border rounded px-3 py-2">
      </div>
      <div>
        <label class="block text-sm font-medium">พักเริ่ม</label>
        <input id="editBreakStartTime" type="time" class="mt-1 w-full border rounded px-3 py-2">
      </div>
      <div>
        <label class="block text-sm font-medium">พักสิ้นสุด</label>
        <input id="editBreakEndTime" type="time" class="mt-1 w-full border rounded px-3 py-2">
      </div>

      <div>
        <label class="block text-sm font-medium">Late In</label>
        <input id="editLateGraceMin" type="number" min="0" class="mt-1 w-full border rounded px-3 py-2">
      </div>
      <div>
        <label class="block text-sm font-medium">Early-out</label>
        <input id="editEarlyLeaveGraceMin" type="number" min="0" class="mt-1 w-full border rounded px-3 py-2">
      </div>
      <div>
        <label class="block text-sm font-medium">Absence if &lt;</label>
        <input id="editAbsenceAfterMin" type="number" min="0" class="mt-1 w-full border rounded px-3 py-2">
      </div>
      <div>
        <label class="block text-sm font-medium">มาตรฐาน/วัน</label>
        <input id="editStandardDailyMinutes" type="number" min="0" class="mt-1 w-full border rounded px-3 py-2">
      </div>
      <div>
        <label class="block text-sm font-medium">พัก (override นาที)</label>
        <input id="editBreakMinutesOverride" type="number" min="0" class="mt-1 w-full border rounded px-3 py-2">
      </div>

      <div>
        <label class="block text-sm font-medium">Active?</label>
        <input id="editIsActive" type="checkbox" class="mt-2">
      </div>
      <div>
        <label class="block text-sm font-medium">ตั้งเป็นค่าเริ่มต้น?</label>
        <input id="editIsDefault" type="checkbox" class="mt-2">
      </div>

      <div class="md:col-span-3 flex gap-2 mt-2">
        <button class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded">บันทึก</button>
        <button id="closeEditModalButton" type="button" class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded">ปิด</button>
      </div>
      <div id="editWorkingScheduleMessage" class="md:col-span-3 text-sm mt-2"></div>
    </form>
  </div>
</div>

<script src="/static/js/time_tracking/working_schedules.js"></script>
{% endblock %}
